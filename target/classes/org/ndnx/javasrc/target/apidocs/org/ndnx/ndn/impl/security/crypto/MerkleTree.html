<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_65) on Wed Dec 11 15:59:51 JST 2013 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
MerkleTree (Project NDNx javalib 0.7.2-SNAPSHOT API)
</TITLE>

<META NAME="date" CONTENT="2013-12-11">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MerkleTree (Project NDNx javalib 0.7.2-SNAPSHOT API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/MerkleTree.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerklePath.html" title="class in org.ndnx.ndn.impl.security.crypto"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/NDNAggregatedSigner.html" title="interface in org.ndnx.ndn.impl.security.crypto"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?org/ndnx/ndn/impl/security/crypto/MerkleTree.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MerkleTree.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.ndnx.ndn.impl.security.crypto</FONT>
<BR>
Class MerkleTree</H2>
<PRE>
<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../../../resources/inherit.gif" ALT="extended by "><B>org.ndnx.ndn.impl.security.crypto.MerkleTree</B>
</PRE>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/NDNMerkleTree.html" title="class in org.ndnx.ndn.impl.security.crypto">NDNMerkleTree</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>MerkleTree</B><DT>extends <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></DL>
</PRE>

<P>
Implementation of a Merkle hash tree. 
 
 Representation based on Knuth, Vol 1, section 2.3.4.5. We represent
 trees as a special sublcass of extended binary
 trees, where empty subtrees are only present in one end
 of the tree.
 
 Tree nodes are numbered starting with 1, which is the
 root. 
 
 Tree nodes are stored in an array, with node i stored at index
 i-1 into the array.
 
 Incomplete binary trees are represented as multi-level extended
 binary trees -- lower-numbered leaves are represented in the
 upper half of the tree, in a layer one closer to the root than
 leaves in the complete subtree.
 
 Total number of nodes in the tree = 2n + 1, where n is the number of leaves.
 
 Taken in terms of node indices (where root == 1), the parent
 of node k is node floor(k/2), and the children of node k are
 nodes 2k and 2k+1. Leaves are numbered from node n+1 through 
 2n+1, where n is the number of leaves.
 
 The sibling index of node k is (k xor 1).
 
 Should we want to get fancy, we could have t-ary trees; the
 construction above works for tree with internal nodes (non-leaves)
 {1,2,...,n}.
 
 The parent of node k is the node floor((k+t-2)/t) = ceil((k-1)/t).
 The children of node k are:
 t(k-1)+2, t(k-1)+3,..., tk+1
 
 In the methods below, we refer to nodes as having a "nodeIndex" -- their
 1-based index into the node array as described above. Leaf nodes also have
 a "leafIndex" -- their index into the set of n leaves. Convenience
 methods are provided to convert between the two.
 
 Store node digests internally as DEROctetStrings for more efficient
 encoding.
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#_digestAlgorithm">_digestAlgorithm</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#_numLeaves">_numLeaves</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;org.bouncycastle.asn1.DEROctetString[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#_tree">_tree</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#MERKLE_OID_PREFIX">MERKLE_OID_PREFIX</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The OID prefix we use to represent Merkle trees.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#ROOT_NODE">ROOT_NODE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node index of 1 (array index of 0).</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#MerkleTree(byte[][], boolean, int, int, int)">MerkleTree</A></B>(byte[][]&nbsp;contentBlocks,
           boolean&nbsp;isDigest,
           int&nbsp;blockCount,
           int&nbsp;baseBlockIndex,
           int&nbsp;lastBlockLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Build a MerkleTree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#MerkleTree(byte[], int, int, int)">MerkleTree</A></B>(byte[]&nbsp;content,
           int&nbsp;offset,
           int&nbsp;length,
           int&nbsp;blockWidth)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Segment content and build a MerkleTree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#MerkleTree(java.lang.String, byte[][], boolean, int, int, int)">MerkleTree</A></B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
           byte[][]&nbsp;contentBlocks,
           boolean&nbsp;isDigest,
           int&nbsp;blockCount,
           int&nbsp;baseBlockIndex,
           int&nbsp;lastBlockLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Build a MerkleTree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#MerkleTree(java.lang.String, byte[], int, int, int)">MerkleTree</A></B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
           byte[]&nbsp;content,
           int&nbsp;offset,
           int&nbsp;length,
           int&nbsp;blockWidth)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Segment content and build a MerkleTree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#MerkleTree(java.lang.String, int)">MerkleTree</A></B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
           int&nbsp;numLeaves)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subclass constructor.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#blockCount(int, int)">blockCount</A></B>(int&nbsp;length,
           int&nbsp;blockWidth)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The number of blocks of blockWidth (bytes) necessary to hold length (bytes)</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeBlockDigest(byte[])">computeBlockDigest</A></B>(byte[]&nbsp;block)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the digest of a block using NDNDigestHelper#DEFAULT_DIGEST_ALGORITHM.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeBlockDigest(int, byte[][], int, int)">computeBlockDigest</A></B>(int&nbsp;leafIndex,
                   byte[][]&nbsp;contentBlocks,
                   int&nbsp;baseBlockIndex,
                   int&nbsp;lastBlockLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the digest of a leaf node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeBlockDigest(int, byte[], int, int)">computeBlockDigest</A></B>(int&nbsp;leafIndex,
                   byte[]&nbsp;content,
                   int&nbsp;offset,
                   int&nbsp;length)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the digest of a leaf node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeBlockDigest(java.lang.String, byte[])">computeBlockDigest</A></B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
                   byte[]&nbsp;content)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the digest of a leaf node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeBlockDigest(java.lang.String, byte[], int, int)">computeBlockDigest</A></B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
                   byte[]&nbsp;content,
                   int&nbsp;offset,
                   int&nbsp;length)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the digest of a leaf node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeLeafValues(byte[][], boolean, int, int)">computeLeafValues</A></B>(byte[][]&nbsp;contentBlocks,
                  boolean&nbsp;isDigest,
                  int&nbsp;baseBlockIndex,
                  int&nbsp;lastBlockLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the raw digest of the leaf content blocks, and format them appropriately.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeLeafValues(byte[], int, int, int)">computeLeafValues</A></B>(byte[]&nbsp;content,
                  int&nbsp;offset,
                  int&nbsp;length,
                  int&nbsp;blockWidth)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the raw digest of the leaf content blocks, and format them appropriately.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeNodeDigest(byte[], byte[])">computeNodeDigest</A></B>(byte[]&nbsp;left,
                  byte[]&nbsp;right)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the digest for an intermediate node with two children.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeNodeDigest(java.lang.String, byte[], byte[])">computeNodeDigest</A></B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;algorithm,
                  byte[]&nbsp;left,
                  byte[]&nbsp;right)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the digest for an intermediate node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#computeNodeValues()">computeNodeValues</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute the intermediate node values by digesting the concatenation of the
 left and right children (or the left child alone if there is no right child).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.bouncycastle.asn1.DEROctetString</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#derGet(int)">derGet</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the digest at the specified node as a DEROctetString</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.bouncycastle.asn1.DEROctetString</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#derRoot()">derRoot</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the DEROctetString wrapped digest of the root node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#digestAlgorithm()">digestAlgorithm</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the digest algorithm used by this tree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#firstLeaf()">firstLeaf</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the node index of the first leaf.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#get(int)">get</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the digest at the specified node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#getNodeIndex(org.bouncycastle.asn1.DEROctetString)">getNodeIndex</A></B>(org.bouncycastle.asn1.DEROctetString&nbsp;node)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Function for validating paths.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#getRootAsEncodedDigest()">getRootAsEncodedDigest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the root node as an encoded PKCS#1 DigestInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#initializeTree(byte[][], boolean, int, int)">initializeTree</A></B>(byte[][]&nbsp;contentBlocks,
               boolean&nbsp;isDigest,
               int&nbsp;baseBlockIndex,
               int&nbsp;lastBlockLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Method called by constructors to fill leaf nodes with digests and compute intermediate
 node values up the tree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#initializeTree(byte[], int, int, int)">initializeTree</A></B>(byte[]&nbsp;content,
               int&nbsp;offset,
               int&nbsp;length,
               int&nbsp;blockWidth)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Method called by constructors to fill leaf nodes with digests and compute intermediate
 node values up the tree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#isLeft(int)">isLeft</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check internal node index (not translated to leaves) to see if it
 is a left or right child.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#isMerkleTree(org.bouncycastle.asn1.x509.AlgorithmIdentifier)">isMerkleTree</A></B>(org.bouncycastle.asn1.x509.AlgorithmIdentifier&nbsp;algorithmId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Does this algorithm identifier indicate a Merkle tree?</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#isRight(int)">isRight</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check internal node index (not translated to leaves) to see if it
 is a left or right child.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#leaf(int)">leaf</A></B>(int&nbsp;leafIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrieve the digest of a given leaf node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#leafNodeIndex(int)">leafNodeIndex</A></B>(int&nbsp;leafIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the node index of a given leaf</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#leftChild(int)">leftChild</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find the index of the left child of a given node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#log2(int)">log2</A></B>(int&nbsp;arg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Helper method</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#maxDepth()">maxDepth</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the maximum depth of this MerkleTree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#maxDepth(int)">maxDepth</A></B>(int&nbsp;numLeaves)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What is the maximum depth of a Merkle tree with
 a given number of leaves.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#maxPathLength(int)">maxPathLength</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What is the maximum path length to a node with this node index,
 including its sibling but not including the root?</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#nodeCount()">nodeCount</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates the number of nodes in this tree</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#nodeCount(int)">nodeCount</A></B>(int&nbsp;numLeaves)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate the number of nodes in a tree with a given number of leaves.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#numLeaves()">numLeaves</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the number of leaves in the tree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#parent(int)">parent</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find the index of the parent of this node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerklePath.html" title="class in org.ndnx.ndn.impl.security.crypto">MerklePath</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#path(int)">path</A></B>(int&nbsp;leafNum)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generate a MerklePath for a given leaf, to use in verifying that
 leaf.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#rightChild(int)">rightChild</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find the index of the right child of a given node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#root()">root</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the root digest</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#sibling(int)">sibling</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find the index of this node's sibling.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerkleTree.html#size()">size</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the size of the tree, in nodes.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="ROOT_NODE"><!-- --></A><H3>
ROOT_NODE</H3>
<PRE>
protected static final int <B>ROOT_NODE</B></PRE>
<DL>
<DD>Node index of 1 (array index of 0).
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../../../constant-values.html#org.ndnx.ndn.impl.security.crypto.MerkleTree.ROOT_NODE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="_tree"><!-- --></A><H3>
_tree</H3>
<PRE>
protected org.bouncycastle.asn1.DEROctetString[] <B>_tree</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="_numLeaves"><!-- --></A><H3>
_numLeaves</H3>
<PRE>
protected int <B>_numLeaves</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="_digestAlgorithm"><!-- --></A><H3>
_digestAlgorithm</H3>
<PRE>
protected <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>_digestAlgorithm</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="MERKLE_OID_PREFIX"><!-- --></A><H3>
MERKLE_OID_PREFIX</H3>
<PRE>
protected static final <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>MERKLE_OID_PREFIX</B></PRE>
<DL>
<DD>The OID prefix we use to represent Merkle trees. Derived from PARC-s sub-arc of Xerox's OID.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../../../constant-values.html#org.ndnx.ndn.impl.security.crypto.MerkleTree.MERKLE_OID_PREFIX">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="MerkleTree(java.lang.String, byte[][], boolean, int, int, int)"><!-- --></A><H3>
MerkleTree</H3>
<PRE>
public <B>MerkleTree</B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
                  byte[][]&nbsp;contentBlocks,
                  boolean&nbsp;isDigest,
                  int&nbsp;blockCount,
                  int&nbsp;baseBlockIndex,
                  int&nbsp;lastBlockLength)
           throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Build a MerkleTree. This initializes the tree with content, builds the leaf
 and intermediate digests, and derives the root digest.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the digest algorithm to use for computing leaf and
   interior node digests of this tree<DD><CODE>contentBlocks</CODE> - the segmented leaf content to be hashed into this 
 Merkle hash tree. One block per leaf.<DD><CODE>isDigest</CODE> - are the content blocks raw content (false), or are they already digested
          with digestAlgorithm? (default algorithm: NDNDigestHelper#DEFAULT_DIGEST_ALGORITHM)<DD><CODE>blockCount</CODE> - the number of those blocks to include (e.g. we may not
        have filled our contentBlocks buffers prior to building the tree). Must be
  at least 2.<DD><CODE>baseBlockIndex</CODE> - the offset into the contentBlocks array at which to start.<DD><CODE>lastBlockLength</CODE> - the number of bytes of the last block to use
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE></DL>
</DL>
<HR>

<A NAME="MerkleTree(byte[], int, int, int)"><!-- --></A><H3>
MerkleTree</H3>
<PRE>
public <B>MerkleTree</B>(byte[]&nbsp;content,
                  int&nbsp;offset,
                  int&nbsp;length,
                  int&nbsp;blockWidth)</PRE>
<DL>
<DD>Segment content and build a MerkleTree. This initializes the tree with content, builds the leaf
 and intermediate digests, and derives the root digest. Uses NDNDigestHelper#DEFAULT_DIGEST_ALGORITHM.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>content</CODE> - the content to segment into leaves and hash into this 
 Merkle hash tree. One blockWidth of content per leaf, except for the last leaf which may
 be shorter.<DD><CODE>offset</CODE> - offset into content at which to start processing data.<DD><CODE>length</CODE> - number of bytes of content to process<DD><CODE>blockWidth</CODE> - the length of leaf blocks to create</DL>
</DL>
<HR>

<A NAME="MerkleTree(java.lang.String, byte[], int, int, int)"><!-- --></A><H3>
MerkleTree</H3>
<PRE>
public <B>MerkleTree</B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
                  byte[]&nbsp;content,
                  int&nbsp;offset,
                  int&nbsp;length,
                  int&nbsp;blockWidth)
           throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Segment content and build a MerkleTree. This initializes the tree with content, builds the leaf
 and intermediate digests, and derives the root digest.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the digest algorithm to use for computing leaf and
   interior node digests of this tree<DD><CODE>content</CODE> - the content to segment into leaves and hash into this 
 Merkle hash tree. One blockWidth of content per leaf, except for the last leaf which may
 be shorter.<DD><CODE>offset</CODE> - offset into content at which to start processing data.<DD><CODE>length</CODE> - number of bytes of content to process<DD><CODE>blockWidth</CODE> - the length of leaf blocks to create
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE></DL>
</DL>
<HR>

<A NAME="MerkleTree(byte[][], boolean, int, int, int)"><!-- --></A><H3>
MerkleTree</H3>
<PRE>
public <B>MerkleTree</B>(byte[][]&nbsp;contentBlocks,
                  boolean&nbsp;isDigest,
                  int&nbsp;blockCount,
                  int&nbsp;baseBlockIndex,
                  int&nbsp;lastBlockLength)</PRE>
<DL>
<DD>Build a MerkleTree. This initializes the tree with content, builds the leaf
 and intermediate digests, and derives the root digest. Uses NDNDigestHelper#DEFAULT_DIGEST_ALGORITHM.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentBlocks</CODE> - the segmented leaf content to be hashed into this 
 Merkle hash tree. One block per leaf.<DD><CODE>isDigest</CODE> - are the content blocks raw content (false), or are they already digested
          with digestAlgorithm? (default algorithm: NDNDigestHelper#DEFAULT_DIGEST_ALGORITHM)<DD><CODE>blockCount</CODE> - the number of those blocks to include (e.g. we may not
        have filled our contentBlocks buffers prior to building the tree). Must be
  at least 2.<DD><CODE>baseBlockIndex</CODE> - the offset into the contentBlocks array at which to start.<DD><CODE>lastBlockLength</CODE> - the amount of the last block to use
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE></DL>
</DL>
<HR>

<A NAME="MerkleTree(java.lang.String, int)"><!-- --></A><H3>
MerkleTree</H3>
<PRE>
protected <B>MerkleTree</B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
                     int&nbsp;numLeaves)</PRE>
<DL>
<DD>Subclass constructor.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - digest algorithm to use. If null, use NDNDigestHelper#DEFAULT_DIGEST_ALGORITHM.<DD><CODE>numLeaves</CODE> - the number of leaf nodes to reserve space for</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="initializeTree(byte[][], boolean, int, int)"><!-- --></A><H3>
initializeTree</H3>
<PRE>
protected void <B>initializeTree</B>(byte[][]&nbsp;contentBlocks,
                              boolean&nbsp;isDigest,
                              int&nbsp;baseBlockIndex,
                              int&nbsp;lastBlockLength)
                       throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Method called by constructors to fill leaf nodes with digests and compute intermediate
 node values up the tree. Does its work by calling computeLeafValues(byte [][], boolean, int, int)
 and computeNodeValues().
 Separate this out to allow subclasses to initialize members before
 building tree.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if the digestAlgorithm specified for this tree is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="initializeTree(byte[], int, int, int)"><!-- --></A><H3>
initializeTree</H3>
<PRE>
protected void <B>initializeTree</B>(byte[]&nbsp;content,
                              int&nbsp;offset,
                              int&nbsp;length,
                              int&nbsp;blockWidth)
                       throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Method called by constructors to fill leaf nodes with digests and compute intermediate
 node values up the tree. Does its work by calling computeLeafValues(byte [], int, int, int)
 and computeNodeValues().
 Separate this out to allow subclasses to initialize members before
 building tree.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if the digestAlgorithm specified for this tree is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="digestAlgorithm()"><!-- --></A><H3>
digestAlgorithm</H3>
<PRE>
public <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>digestAlgorithm</B>()</PRE>
<DL>
<DD>Returns the digest algorithm used by this tree.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the digest algorithm used</DL>
</DD>
</DL>
<HR>

<A NAME="parent(int)"><!-- --></A><H3>
parent</H3>
<PRE>
public static int <B>parent</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Find the index of the parent of this node.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - is a (1-based) node index whose parent we want to find.
<DT><B>Returns:</B><DD>Returns 0 if this node has no parent (is the root), otherwise
        the parent's index</DL>
</DD>
</DL>
<HR>

<A NAME="leftChild(int)"><!-- --></A><H3>
leftChild</H3>
<PRE>
public int <B>leftChild</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Find the index of the left child of a given node.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - the (1-based) index of the node whose child we want to find
<DT><B>Returns:</B><DD>the index of the left child, or size() if no left child.</DL>
</DD>
</DL>
<HR>

<A NAME="rightChild(int)"><!-- --></A><H3>
rightChild</H3>
<PRE>
public int <B>rightChild</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Find the index of the right child of a given node.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - the (1-based) index of the node whose child we want to find
<DT><B>Returns:</B><DD>the index of the right child, or size() if no left child.</DL>
</DD>
</DL>
<HR>

<A NAME="sibling(int)"><!-- --></A><H3>
sibling</H3>
<PRE>
public static int <B>sibling</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Find the index of this node's sibling.
 Everything always has a sibling, in this formulation of 
 (not-necessarily-complete binary trees). For root, returns 0.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - the (1-based) index of the node whose sibling we want to find
<DT><B>Returns:</B><DD>the (1-based) index of the sibling, or 0 for if nodeIndex is the root.</DL>
</DD>
</DL>
<HR>

<A NAME="isRight(int)"><!-- --></A><H3>
isRight</H3>
<PRE>
public static boolean <B>isRight</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Check internal node index (not translated to leaves) to see if it
 is a left or right child. Internal nodes for a layer always start
 with an even index, as 1 is the root and the only layer with one
 member. Every other layer has an even number of nodes (except for
 possibly a dangling child at the end). So, left nodes have even
 indices, and right nodes have odd ones.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - node to check whether it is a right child
<DT><B>Returns:</B><DD>true if it is a right child, false if a left child</DL>
</DD>
</DL>
<HR>

<A NAME="isLeft(int)"><!-- --></A><H3>
isLeft</H3>
<PRE>
public static boolean <B>isLeft</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Check internal node index (not translated to leaves) to see if it
 is a left or right child. Internal nodes for a layer always start
 with an even index, as 1 is the root and the only layer with one
 member. Every other layer has an even number of nodes (except for
 possibly a dangling child at the end). So, left nodes have even
 indices, and right nodes have odd ones.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - node to check whether it is a left child
<DT><B>Returns:</B><DD>true if it is a left child, false if a right child</DL>
</DD>
</DL>
<HR>

<A NAME="root()"><!-- --></A><H3>
root</H3>
<PRE>
public byte[] <B>root</B>()</PRE>
<DL>
<DD>Return the root digest
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the root digest</DL>
</DD>
</DL>
<HR>

<A NAME="derRoot()"><!-- --></A><H3>
derRoot</H3>
<PRE>
public org.bouncycastle.asn1.DEROctetString <B>derRoot</B>()</PRE>
<DL>
<DD>Get the DEROctetString wrapped digest of the root node.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>a DEROctetString object containing the root node digest.</DL>
</DD>
</DL>
<HR>

<A NAME="size()"><!-- --></A><H3>
size</H3>
<PRE>
public int <B>size</B>()</PRE>
<DL>
<DD>Get the size of the tree, in nodes. (This is the number of nodes,
 not the number of leaves.)
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the tree size.</DL>
</DD>
</DL>
<HR>

<A NAME="get(int)"><!-- --></A><H3>
get</H3>
<PRE>
public byte[] <B>get</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Returns the digest at the specified node.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - 1-based node index
<DT><B>Returns:</B><DD>the digest for this node</DL>
</DD>
</DL>
<HR>

<A NAME="derGet(int)"><!-- --></A><H3>
derGet</H3>
<PRE>
public org.bouncycastle.asn1.DEROctetString <B>derGet</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Returns the digest at the specified node as a DEROctetString
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - 1-based node index
<DT><B>Returns:</B><DD>the digest for this node</DL>
</DD>
</DL>
<HR>

<A NAME="numLeaves()"><!-- --></A><H3>
numLeaves</H3>
<PRE>
public int <B>numLeaves</B>()</PRE>
<DL>
<DD>Get the number of leaves in the tree.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>returns the number of leaves</DL>
</DD>
</DL>
<HR>

<A NAME="nodeCount(int)"><!-- --></A><H3>
nodeCount</H3>
<PRE>
public static int <B>nodeCount</B>(int&nbsp;numLeaves)</PRE>
<DL>
<DD>Calculate the number of nodes in a tree with a given number of leaves.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>numLeaves</CODE> - the number of leaves
<DT><B>Returns:</B><DD>the number of nodes in the tree</DL>
</DD>
</DL>
<HR>

<A NAME="nodeCount()"><!-- --></A><H3>
nodeCount</H3>
<PRE>
public int <B>nodeCount</B>()</PRE>
<DL>
<DD>Calculates the number of nodes in this tree
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the number of nodes</DL>
</DD>
</DL>
<HR>

<A NAME="firstLeaf()"><!-- --></A><H3>
firstLeaf</H3>
<PRE>
public int <B>firstLeaf</B>()</PRE>
<DL>
<DD>Returns the node index of the first leaf.
 The node index of the first leaf is either size()-numleaves(), or
 nodeIndex = numLeaves.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the first leaf's node index</DL>
</DD>
</DL>
<HR>

<A NAME="leafNodeIndex(int)"><!-- --></A><H3>
leafNodeIndex</H3>
<PRE>
public int <B>leafNodeIndex</B>(int&nbsp;leafIndex)</PRE>
<DL>
<DD>Get the node index of a given leaf
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>leafIndex</CODE> - the index of a leaf
<DT><B>Returns:</B><DD>its node index</DL>
</DD>
</DL>
<HR>

<A NAME="leaf(int)"><!-- --></A><H3>
leaf</H3>
<PRE>
public byte[] <B>leaf</B>(int&nbsp;leafIndex)</PRE>
<DL>
<DD>Retrieve the digest of a given leaf node. Returns null if there is
 no leaf leafIndex.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>leafIndex</CODE> - leaf index, starting at 0 for the first leaf.
<DT><B>Returns:</B><DD>its digest</DL>
</DD>
</DL>
<HR>

<A NAME="path(int)"><!-- --></A><H3>
path</H3>
<PRE>
public <A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerklePath.html" title="class in org.ndnx.ndn.impl.security.crypto">MerklePath</A> <B>path</B>(int&nbsp;leafNum)</PRE>
<DL>
<DD>Generate a MerklePath for a given leaf, to use in verifying that
 leaf.
 
 There are a variety of traversal algorithms for 
 computing/reading Merkle hash trees.
 
 We need to represent the leaves so that the user
 a) knows what order they come in, and b) also knows
 which is the leaf being represented. The cheapest
 way to do that is to represent the leaves in order,
 and also start out with an indication of whether
 this leaf is the left or right of the last pair.
 To make this most general and easy to use, we
 will represent this path as
  
 MerklePath ::= SEQUENCE {
        nodeIndex INTEGER, 
  nodes NodeList 
 }
  
 NodeList ::= SEQUENCE OF OCTET STRING
  
 the nodeIndex here is the index of the leaf node in
 the tree as a whole (not just among the leaves), and
 the nodes list contains neither the digest of the
 leaf itself nor the root of the tree.
 
 We could probably save a few bytes by not encoding this
 as DER, and simply packing in the bytes to represent this
 data -- this encoding offers a fair amount of ease of parsing
 and clarity, at the cost of probably 5 + 2*pathLength bytes of overhead,
 or 20 bytes in typical paths. At some point this may
 seem too much, and we will move to a more compact encoding.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>leafNum</CODE> - the leaf index of the leaf
<DT><B>Returns:</B><DD>the MerklePath for verifying that leaf<DT><B>See Also:</B><DD><A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerklePath.html" title="class in org.ndnx.ndn.impl.security.crypto"><CODE>MerklePath</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="maxPathLength(int)"><!-- --></A><H3>
maxPathLength</H3>
<PRE>
public static int <B>maxPathLength</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>What is the maximum path length to a node with this node index,
 including its sibling but not including the root?
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - the node to find the path length for
<DT><B>Returns:</B><DD>the maximum path length</DL>
</DD>
</DL>
<HR>

<A NAME="maxDepth(int)"><!-- --></A><H3>
maxDepth</H3>
<PRE>
public static int <B>maxDepth</B>(int&nbsp;numLeaves)</PRE>
<DL>
<DD>What is the maximum depth of a Merkle tree with
 a given number of leaves. If the tree isn't balanced,
 many nodes may have shorter paths than maxDepth.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>numLeaves</CODE> - the number of leaves in the tree.
<DT><B>Returns:</B><DD>the maximum depth of the tree</DL>
</DD>
</DL>
<HR>

<A NAME="maxDepth()"><!-- --></A><H3>
maxDepth</H3>
<PRE>
public int <B>maxDepth</B>()</PRE>
<DL>
<DD>Get the maximum depth of this MerkleTree.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the depth</DL>
</DD>
</DL>
<HR>

<A NAME="computeLeafValues(byte[][], boolean, int, int)"><!-- --></A><H3>
computeLeafValues</H3>
<PRE>
protected void <B>computeLeafValues</B>(byte[][]&nbsp;contentBlocks,
                                 boolean&nbsp;isDigest,
                                 int&nbsp;baseBlockIndex,
                                 int&nbsp;lastBlockLength)
                          throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the raw digest of the leaf content blocks, and format them appropriately.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>contentBlocks</CODE> - the leaf content, one leaf per array<DD><CODE>isDigest</CODE> - have these been digested already, or do we need to digest
        them using computeBlockDigest(int, byte [][], int, int)?<DD><CODE>baseBlockIndex</CODE> - first block in the array to use<DD><CODE>lastBlockLength</CODE> - number of bytes of the last block to use; N/A if isDigest is true
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if digestAlgorithm is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="computeLeafValues(byte[], int, int, int)"><!-- --></A><H3>
computeLeafValues</H3>
<PRE>
protected void <B>computeLeafValues</B>(byte[]&nbsp;content,
                                 int&nbsp;offset,
                                 int&nbsp;length,
                                 int&nbsp;blockWidth)
                          throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the raw digest of the leaf content blocks, and format them appropriately.
 uses computeBlockDigest(int, byte[], int, int) to compute the leaf digest.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>content</CODE> - the content to segment into leaves and hash into this 
 Merkle hash tree. One blockWidth of content per leaf, except for the last leaf which may
 be shorter.<DD><CODE>offset</CODE> - offset into content at which to start processing data.<DD><CODE>length</CODE> - number of bytes of content to process<DD><CODE>blockWidth</CODE> - the length of leaf blocks to create
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if digestAlgorithm is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="computeNodeValues()"><!-- --></A><H3>
computeNodeValues</H3>
<PRE>
protected void <B>computeNodeValues</B>()
                          throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the intermediate node values by digesting the concatenation of the
 left and right children (or the left child alone if there is no right child).
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if digestAlgorithm is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="getNodeIndex(org.bouncycastle.asn1.DEROctetString)"><!-- --></A><H3>
getNodeIndex</H3>
<PRE>
public int <B>getNodeIndex</B>(org.bouncycastle.asn1.DEROctetString&nbsp;node)</PRE>
<DL>
<DD>Function for validating paths. Given a digest, it returns what node in
 the tree has that digest. If no node has that digest, returns 0. 
 If argument is null, returns -1. Slow.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - the node digest to validate
<DT><B>Returns:</B><DD>the nodeIndex of the node with that digest</DL>
</DD>
</DL>
<HR>

<A NAME="getRootAsEncodedDigest()"><!-- --></A><H3>
getRootAsEncodedDigest</H3>
<PRE>
public byte[] <B>getRootAsEncodedDigest</B>()</PRE>
<DL>
<DD>Get the root node as an encoded PKCS#1 DigestInfo.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the encoded DigestInfo</DL>
</DD>
</DL>
<HR>

<A NAME="computeBlockDigest(int, byte[][], int, int)"><!-- --></A><H3>
computeBlockDigest</H3>
<PRE>
protected byte[] <B>computeBlockDigest</B>(int&nbsp;leafIndex,
                                    byte[][]&nbsp;contentBlocks,
                                    int&nbsp;baseBlockIndex,
                                    int&nbsp;lastBlockLength)
                             throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the digest of a leaf node.
 Separate this out so that it can be overridden.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>leafIndex</CODE> - The index of the leaf we are computing the digest of.<DD><CODE>contentBlocks</CODE> - The array of content blocks containing the leaf content.<DD><CODE>baseBlockIndex</CODE> - The first content block in the array containing leaf content (if rolling buffers).
                                          numLeaves() blocks contain leaf content, so the last block used is blockOffset+numLeaves().<DD><CODE>lastBlockLength</CODE> - the number of bytes of the last block to use, can be smaller than
    the number available
<DT><B>Returns:</B><DD>the digest for this leaf
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="computeBlockDigest(int, byte[], int, int)"><!-- --></A><H3>
computeBlockDigest</H3>
<PRE>
protected byte[] <B>computeBlockDigest</B>(int&nbsp;leafIndex,
                                    byte[]&nbsp;content,
                                    int&nbsp;offset,
                                    int&nbsp;length)
                             throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the digest of a leaf node.
 Separate this out so that it can be overridden.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>leafIndex</CODE> - The index of the leaf we are computing the digest of.<DD><CODE>content</CODE> - the content to segment into leaves and hash into this 
 Merkle hash tree.<DD><CODE>offset</CODE> - offset into content at which this leaf starts<DD><CODE>length</CODE> - number of bytes of content in this leaf
<DT><B>Returns:</B><DD>the digest for this leaf
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if digestAlgorithm is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="computeBlockDigest(java.lang.String, byte[])"><!-- --></A><H3>
computeBlockDigest</H3>
<PRE>
public static byte[] <B>computeBlockDigest</B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
                                        byte[]&nbsp;content)
                                 throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the digest of a leaf node.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the digest algorithm to use<DD><CODE>content</CODE> - the content of this leaf
<DT><B>Returns:</B><DD>the digest for this leaf
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if digestAlgorithm is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="computeBlockDigest(java.lang.String, byte[], int, int)"><!-- --></A><H3>
computeBlockDigest</H3>
<PRE>
public static byte[] <B>computeBlockDigest</B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;digestAlgorithm,
                                        byte[]&nbsp;content,
                                        int&nbsp;offset,
                                        int&nbsp;length)
                                 throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the digest of a leaf node.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the digest algorithm to use<DD><CODE>content</CODE> - the content to segment into leaves and hash into this 
 Merkle hash tree.<DD><CODE>offset</CODE> - offset into content at which this leaf starts<DD><CODE>length</CODE> - number of bytes of content in this leaf
<DT><B>Returns:</B><DD>the digest for this leaf
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE> - if digestAlgorithm is unknown</DL>
</DD>
</DL>
<HR>

<A NAME="computeBlockDigest(byte[])"><!-- --></A><H3>
computeBlockDigest</H3>
<PRE>
public static byte[] <B>computeBlockDigest</B>(byte[]&nbsp;block)</PRE>
<DL>
<DD>Compute the digest of a block using NDNDigestHelper#DEFAULT_DIGEST_ALGORITHM.
 DKS TODO - check -- was being by MerklePath to compute digest for root without
 properly recovering OID from encoded path.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>block</CODE> - block to digest
<DT><B>Returns:</B><DD>block digest</DL>
</DD>
</DL>
<HR>

<A NAME="computeNodeDigest(java.lang.String, byte[], byte[])"><!-- --></A><H3>
computeNodeDigest</H3>
<PRE>
public static byte[] <B>computeNodeDigest</B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;algorithm,
                                       byte[]&nbsp;left,
                                       byte[]&nbsp;right)
                                throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></PRE>
<DL>
<DD>Compute the digest for an intermediate node. If this is a last left child (right is null),
 simply hash left alone.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security">NoSuchAlgorithmException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="computeNodeDigest(byte[], byte[])"><!-- --></A><H3>
computeNodeDigest</H3>
<PRE>
public static byte[] <B>computeNodeDigest</B>(byte[]&nbsp;left,
                                       byte[]&nbsp;right)</PRE>
<DL>
<DD>Compute the digest for an intermediate node with two children.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>left</CODE> - left child<DD><CODE>right</CODE> - right child
<DT><B>Returns:</B><DD>parent digest</DL>
</DD>
</DL>
<HR>

<A NAME="isMerkleTree(org.bouncycastle.asn1.x509.AlgorithmIdentifier)"><!-- --></A><H3>
isMerkleTree</H3>
<PRE>
public static boolean <B>isMerkleTree</B>(org.bouncycastle.asn1.x509.AlgorithmIdentifier&nbsp;algorithmId)</PRE>
<DL>
<DD>Does this algorithm identifier indicate a Merkle tree?
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>algorithmId</CODE> - the algorithm identifier
<DT><B>Returns:</B><DD>true if its a merkle tree, false otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="log2(int)"><!-- --></A><H3>
log2</H3>
<PRE>
public static double <B>log2</B>(int&nbsp;arg)</PRE>
<DL>
<DD>Helper method
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>arg</CODE> - 
<DT><B>Returns:</B><DD>log base 2 of arg</DL>
</DD>
</DL>
<HR>

<A NAME="blockCount(int, int)"><!-- --></A><H3>
blockCount</H3>
<PRE>
public static int <B>blockCount</B>(int&nbsp;length,
                             int&nbsp;blockWidth)</PRE>
<DL>
<DD>The number of blocks of blockWidth (bytes) necessary to hold length (bytes)
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>length</CODE> - the buffer length<DD><CODE>blockWidth</CODE> - the segment with
<DT><B>Returns:</B><DD>the number of blocks</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/MerkleTree.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/MerklePath.html" title="class in org.ndnx.ndn.impl.security.crypto"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../../org/ndnx/ndn/impl/security/crypto/NDNAggregatedSigner.html" title="interface in org.ndnx.ndn.impl.security.crypto"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?org/ndnx/ndn/impl/security/crypto/MerkleTree.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MerkleTree.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2013. All Rights Reserved.
</BODY>
</HTML>
